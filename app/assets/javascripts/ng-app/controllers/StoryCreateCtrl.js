(function(){
  function StoryCreateCtrl($scope, StoriesSrv, PagesSrv){
    // console.log($scope.storyTitle);

    $scope.submit = function(){
      StoriesSrv.create(
        {
          title: $scope.title,
          description: $scope.description,
          summary: $scope.summary
        }
      ).$promise.then(function(data){
        var story = data;

        // story.pages.create()
        PagesSrv.create(
          {
            story_id: story.id,
            title: '[AUTO]',
            description: 'Autogenerated'
          }
        ).$promise.then(function(data){
          story.pages.push(data);
        });
      });

      // console.log('story',story);
      // console.log('story id', story.id)


    }
  }

  angular
    .module('fatebook')
    .controller('StoryCreateCtrl', ['$scope', 'StoriesSrv', 'PagesSrv', StoryCreateCtrl]);
})();
